<!--

    The Kuali Financial System, a comprehensive financial management system for higher education.

    Copyright 2005-2021 Kuali, Inc.

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->
<!--
    CU Customization: Convert "local" attributes to "bean" attributes, like in the FINP-7916 changes to similar files.
    This overlay should be removed when upgrading to the 2021-01-28 financials patch or later,
    given that this particular file does not exist in the KEW-upgraded KFS code.
-->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
               http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

    <import resource="classpath:org/kuali/rice/core/CommonSpringBeans.xml"/>
    <import resource="classpath:org/kuali/kfs/coreservice/config/_CoreServiceOjbSpringBeans.xml"/>
    <import resource="classpath:org/kuali/kfs/coreservice/config/_CoreServiceCommonSpringBeans.xml"/>

    <bean id="cf.coreService.cacheManagerRegistry" class="org.kuali.rice.core.impl.cache.CacheManagerRegistryImpl"
          p:cacheManager-ref="cf.coreServiceDistributedCacheManager"/>

    <bean id="cf.coreServiceDistributedCacheManager" class="org.kuali.rice.core.impl.cache.DistributedCacheManagerDecorator"
          p:cacheManager-ref="cf.coreServiceLocalCacheManager"
          p:serviceName="{http://rice.kuali.org/core/v2_0}coreServiceCacheAdminService"/>

    <bean id="cf.namespaceService" class="org.kuali.kfs.coreservice.impl.namespace.NamespaceServiceImpl"
          p:businessObjectService-ref="cf.businessObjectService"/>

    <bean id="componentSetDao" class="org.kuali.kfs.coreservice.impl.component.ComponentSetDaoOjbImpl" lazy-init="true"
          p:jcdAlias="coreServiceDataSource"/>

    <bean id="componentService" class="org.kuali.kfs.coreservice.impl.component.ComponentServiceImpl"
          p:businessObjectService-ref="cf.businessObjectService" p:componentSetDao-ref="componentSetDao"/>

    <bean id="cf.parameterRepositoryService" class="org.kuali.kfs.coreservice.impl.parameter.ParameterRepositoryServiceImpl"
          p:businessObjectService-ref="cf.businessObjectService"
          p:criteriaLookupService-ref="cf.criteriaLookupService"/>

    <bean id="cf.parameterService" class="org.kuali.kfs.coreservice.impl.parameter.ParameterServiceImpl"
          p:parameterRepositoryService-ref="cf.parameterRepositoryService"
          p:kualiModuleService-ref="cf.kualiModuleService" p:applicationId="${application.id}"/>

    <bean id="cf.styleService" class="org.kuali.kfs.coreservice.impl.style.StyleServiceImpl"
          p:styleRepositoryService-ref="cf.styleRepositoryService"/>

    <bean id="rice.coreService.import.dataDictionaryService"
          class="org.kuali.kfs.krad.config.GlobalResourceLoaderServiceFactoryBean"
          p:serviceName="dataDictionaryService"/>

    <bean id="rice.coreService.import.persistenceServiceOjb"
          class="org.kuali.kfs.krad.config.GlobalResourceLoaderServiceFactoryBean"
          p:serviceName="persistenceServiceOjb"/>

    <bean id="cf.styleRepositoryService" class="org.kuali.kfs.coreservice.impl.style.StyleRepositoryServiceImpl"
          p:styleXmlParser-ref="cf.styleXmlLoader" p:styleDao-ref="styleDao"/>

    <bean id="cf.styleXmlLoader" class="org.kuali.kfs.coreservice.impl.style.StyleXmlParserImpl"
          p:styleRepositoryService-ref="cf.styleRepositoryService"/>

    <bean id="rice.coreService.import.xmlImpexRegistry"
          class="org.kuali.kfs.krad.config.GlobalResourceLoaderServiceFactoryBean" p:serviceName="xmlImpexRegistry"/>

    <bean id="coreImpexRegistrations" class="org.kuali.rice.core.framework.impex.xml.XmlImpexRegistrationBean"
          p:xmlImpexRegistry-ref="rice.coreService.import.xmlImpexRegistry">
        <property name="xmlLoadersToRegister">
            <list>
                <ref bean="cf.styleXmlLoader"/>
            </list>
        </property>
    </bean>

    <bean id="cf.coreServiceServerModuleConfiguration" class="org.kuali.kfs.krad.bo.ModuleConfiguration"
          p:namespaceCode="KR-CR" p:dataSourceName="coreServiceDataSource" p:initializeDataDictionary="true"
          p:dataDictionaryService-ref="cf.dataDictionaryService" p:persistenceService-ref="cf.persistenceServiceOjb">
        <property name="dataDictionaryPackages">
            <list>
                <value>classpath:org/kuali/kfs/coreservice/web/parameter/ParameterMaintenanceDocument.xml</value>
            </list>
        </property>
        <property name="packagePrefixes">
            <list>
                <value>org.kuali.kfs.coreservice</value>
                <value>org.kuali.kfs.coreservice.impl.namespace</value>
                <value>org.kuali.kfs.coreservice.impl.parameter</value>
                <value>org.kuali.kfs.coreservice.impl.component</value>
            </list>
        </property>
        <property name="externalizableBusinessObjectImplementations">
            <map>
                <entry key="org.kuali.kfs.coreservice.framework.component.ComponentEbo"
                       value="org.kuali.kfs.coreservice.impl.component.ComponentBo"/>
                <entry key="org.kuali.kfs.coreservice.framework.namespace.NamespaceEbo"
                       value="org.kuali.kfs.coreservice.impl.namespace.NamespaceBo"/>
                <entry key="org.kuali.kfs.coreservice.framework.parameter.ParameterEbo"
                       value="org.kuali.kfs.coreservice.impl.parameter.ParameterBo"/>
                <entry key="org.kuali.kfs.coreservice.framework.parameter.ParameterTypeEbo"
                       value="org.kuali.kfs.coreservice.impl.parameter.ParameterTypeBo"/>
            </map>
        </property>
    </bean>

    <bean id="cf.coreServiceServerModule" class="org.kuali.kfs.krad.service.impl.ModuleServiceBase"
          p:moduleConfiguration-ref="cf.coreServiceServerModuleConfiguration"
          p:kualiModuleService-ref="cf.kualiModuleService"/>

    <bean id="rice.coreService.transaction-proxies"
          class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
        <property name="interceptorNames">
            <list>
                <idref bean="matchAllTxInterceptor"/>
            </list>
        </property>
        <property name="beanNames">
            <list>
                <idref bean="componentService"/>
                <idref bean="cf.parameterRepositoryService"/>
                <idref bean="cf.styleService"/>
                <idref bean="cf.styleRepositoryService"/>
                <idref bean="cf.styleXmlLoader"/>
            </list>
        </property>
    </bean>

    <bean id="cf.componentBo" class="org.kuali.kfs.coreservice.impl.component.ComponentBo"
          p:namespaceService-ref="cf.namespaceService"/>
</beans>
