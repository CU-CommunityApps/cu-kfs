<!--
   Copyright Cornell University
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU Affero General Public License as
   published by the Free Software Foundation, either version 3 of the
   License, or (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU Affero General Public License for more details.

   You should have received a copy of the GNU Affero General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<!--
   Portions Modified 04/2016 and Copyright Indiana University
   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU Affero General Public License as
   published by the Free Software Foundation, either version 3 of the
   License, or (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU Affero General Public License for more details.

   You should have received a copy of the GNU Affero General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">

	<bean id="cu-fp" parent="fpModuleConfiguration-parentBean">
		<property name="packagePrefixes">
            <list merge="true">
                <value>edu.cornell.kfs.fp</value>
            </list>
        </property>
        <property name="dataDictionaryPackages">
            <list>
                <value>classpath:edu/cornell/kfs/fp/document/datadictionary/*.xml</value>
                <value>classpath:edu/cornell/kfs/fp/businessobject/datadictionary/*.xml</value>
            </list>
        </property>
        <property name="databaseRepositoryFilePaths">
            <list merge ="true">
                <value>edu/cornell/kfs/fp/cu-ojb-fp.xml</value>
            </list>
        </property>
        <property name="fiscalYearMakers">
            <list/>
        </property>
        <property name="scriptConfigurationFilePaths">
            <list/>
        </property>
        <property name="jobNames">
            <list merge="true">
                <value>incomingACHandWiresBatchJob</value>
                <value>procurementCardSummaryFeedJob</value>
                <value>loadAWSBillsBatchJob</value>
                <value>approveDisbursementVouchersSpawnedByRecurringDvJob</value>
            </list>
        </property>
        <property name="batchFileDirectories">
            <list merge="true">
                <value>${staging.directory}/fp</value>
            </list>
        </property>
    </bean>

    <bean id="cu-fpModuleService" parent="fpModuleService-parentBean">
        <property name="moduleConfiguration" ref="cu-fp"/>
    </bean>

    <bean id="procurementCardCreateDocumentService" class="edu.cornell.kfs.fp.batch.service.impl.ProcurementCardCreateDocumentServiceImpl" parent="procurementCardCreateDocumentService-parentBean"/>
    
    <bean id="procurementCardDocumentJob" parent="scheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="procurementCardLoadStep" />
                <ref bean="procurementCardLoadFlatFileStep"/>
                <ref bean="procurementCardCreateDocumentsStep" />
                <ref bean="procurementCardRouteDocumentsStep" />
                <ref bean="procurementCardAutoApproveDocumentsStep" />
            </list>
        </property>
    </bean>

    <bean id="procurementCardSummaryFeedJob" parent="scheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="procurementCardSummaryFeedStep" />
            </list>
        </property>
    </bean>

    <bean id="approveDisbursementVouchersSpawnedByRecurringDvJob" parent="scheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="approveDvsSpawnedByRecurringDvStep" />
            </list>
        </property>
    </bean>

    <bean id="procurementCardLoadTransactionsService"  parent="procurementCardLoadTransactionsService-parentBean"/> 
    <bean id="procurementCardLoadFlatTransactionsService" class="edu.cornell.kfs.fp.batch.service.impl.ProcurementCardLoadFlatTransactionsServiceImpl" parent="procurementCardLoadTransactionsService-parentBean" >
        <property name="procurementCardInputFileType">
            <ref bean="procurementCardFlatInputFileType" />
        </property>
    </bean>
    
    <bean id="procurementCardLoadStep" parent="procurementCardLoadStep-parentBean"/>
    <bean id="procurementCardLoadFlatFileStep" class="edu.cornell.kfs.fp.batch.ProcurementCardLoadFlatFileStep" parent="procurementCardLoadStep-parentBean" >
        <property name="procurementCardLoadTransactionsService">
            <ref bean="procurementCardLoadFlatTransactionsService" />
        </property>
        <property name="procurementCardInputFileType">
            <ref bean="procurementCardFlatInputFileType" />
        </property>
    </bean>

    <bean id="procurementCardSummaryFeedStep" class="edu.cornell.kfs.fp.batch.ProcurementCardSummaryFeedStep" parent="step">
        <property name="procurementCardSummaryFeedService" ref="procurementCardSummaryFeedService" />
        <property name="batchInputFileService"  ref="batchInputFileService" />
        <property name="dateTimeService"  ref="dateTimeService" />
        <property name="procurementCardSummaryFlatInputFileType"  ref="procurementCardSummaryFlatInputFileType" />
        <property name="businessObjectService" ref="businessObjectService" />
    </bean> 

    <bean id="approveDvsSpawnedByRecurringDvStep" class="edu.cornell.kfs.fp.batch.ApproveDvsSpawnedByRecurringDvStep" parent="step">
        <property name="recurringDisbursementVoucherDocumentService" ref="recurringDisbursementVoucherDocumentService"/>
    </bean>

    <bean id="procurementCardSummaryFeedService" parent="procurementCardSummaryFeedService-parentBean"/>

    <bean id="procurementCardSummaryFeedService-parentBean" class="edu.cornell.kfs.fp.batch.service.impl.ProcurementCardSummaryFeedServiceImpl" abstract="true">
        <property name="batchInputFileService">
            <ref bean="batchInputFileService" />
        </property>
        <property name="procurementCardSummaryFlatInputFileType">
            <ref bean="procurementCardSummaryFlatInputFileType" />
        </property>
        <property name="businessObjectService" ref="businessObjectService" />
        <property name="dateTimeService" ref="dateTimeService" />
    </bean>
    
    <bean id="procurementCardSummaryFlatInputFileType" class= "edu.cornell.kfs.fp.batch.ProcurementCardSummaryFlatInputFileType">
        <property name="directoryPath">
           <value>${staging.directory}/fp/pcardSummary</value>
        </property>
        <property name="fileExtension">
           <value>data</value>
        </property>
        <property name="dateTimeService">
           <ref bean="dateTimeService"/>
        </property>
        <property name="flatFileSpecification">
            <ref bean="pCardSummaryFlatFileSpecification"/>
       </property>

       <property name="processor" ref="ProcurementCardSummaryFlatInputFileHandler" />
    </bean>

    <bean id="ProcurementCardSummaryFlatInputFileHandler" parent="ProcurementCardSummaryFlatInputFileHandler-parentBean" />
    <bean id="ProcurementCardSummaryFlatInputFileHandler-parentBean" class="edu.cornell.kfs.fp.batch.ProcurementCardSummaryFlatInputFileHandler" abstract="true"/>
    
    <bean id="pCardSummaryFlatFileSpecification" parent="FixedWidthFlatFileSpecification" p:defaultBusinessObjectClass="edu.cornell.kfs.fp.businessobject.ProcurementCardSummary">
        <property name="objectSpecifications">
            <list>
                <bean parent="FlatFileObjectSpecification" p:businessObjectClass="edu.cornell.kfs.fp.businessobject.ProcurementCardSummary">
                    <property name="parseProperties">
                        <list>
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="cardHolderAccountNumber" p:start="0" p:end="4" p:rightTrim="true" />
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="cardHolderName" p:start="16" p:end="41" p:rightTrim="true" />    
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="emplid" p:start="41" p:end="50" p:rightTrim="true" />
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="netid" p:start="50" p:end="65" p:rightTrim="true" />
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="accountStatus" p:start="65" p:end="75" p:rightTrim="true" />
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="cycleStartDate" p:start="75" p:end="83" />
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="summaryAmount" p:start="83" p:end="100" p:rightTrim="true" />
                            <bean parent="FixedWidthFlatFilePropertySpecification" p:propertyName="loadDate" p:start="100" p:end="108" />
                        </list>
                    </property>
                </bean>
                
            </list>
        </property>
    </bean>
    
    <bean id="procurementCardFlatInputFileType" class="edu.cornell.kfs.fp.batch.ProcurementCardFlatInputFileType"> 
        <property name="directoryPath">
           <value>${staging.directory}/fp/procurementCard</value>
        </property>
        <property name="fileExtension">
           <value>data</value>
        </property>
        <property name="parameterService">
            <ref bean="parameterService"/>
        </property>
        <property name="procurementCardErrorEmailService">
            <ref bean="procurementCardErrorEmailService"/>
        </property>
        <property name="dateTimeService">
           <ref bean="dateTimeService"/>
        </property>
    </bean>
    
     <bean id="procurementCardInputFileType"  parent="procurementCardInputFileType-parentBean"/>
    
    <bean id="procurementCardErrorEmailService" class="edu.cornell.kfs.fp.batch.service.impl.ProcurementCardErrorEmailServiceImpl">
        <property name="parameterService">
            <ref bean="parameterService"/>
        </property>
        <property name="emailService">
            <ref bean="emailService"/>
        </property>
    </bean>
    
    <bean id="debitDeterminerService" class="edu.cornell.kfs.fp.document.service.impl.DebitDeterminerServiceImpl">
        <property name="optionsService">
            <ref bean="optionsService"/>
        </property>
        <property name="accountingDocumentRuleUtils">
            <ref bean="accountingDocumentRuleHelperService"/>
        </property>
    </bean>

    <bean id="cuLegacyTravelService" class="edu.cornell.kfs.fp.document.service.impl.CULegacyTravelServiceImpl">
        <property name="updateTripWsdl">
            <value>${cu.legacy.travel.wsdl}</value>
        </property>
        <property name="updateTripEndpoint">
            <value>${cu.legacy.travel.endpoint}</value>
        </property>        
        <property name="travelUrl">
            <value>${cu.legacy.travel.url}</value>
        </property>
    </bean>
    
    <bean id="disbursementVoucherPayeeService" parent="disbursementVoucherPayeeService-parentBean" class="edu.cornell.kfs.fp.document.service.impl.CuDisbursementVoucherPayeeServiceImpl" />
     	
 	<bean id="disbursementVoucherPaymentReasonService" parent="disbursementVoucherPaymentReasonService-parentBean" class="edu.cornell.kfs.fp.document.service.impl.CuDisbursementVoucherPaymentReasonServiceImpl" >
 	
		<property name="disbursementVoucherPayeeService">
			<ref bean="disbursementVoucherPayeeService" />
		</property>
	</bean>
	
	<bean id="disbursementPayeeLookupable"  parent="disbursementPayeeLookupable-parentBean" scope="prototype">
		<property name="lookupableHelperService">
			<ref bean="disbursementPayeeLookupableHelperService" />
		</property>
	</bean>
	
	<bean id="disbursementPayeeLookupableHelperService" parent="disbursementPayeeLookupableHelperService-parentBean" class="edu.cornell.kfs.fp.businessobject.lookup.CuDisbursementPayeeLookupableHelperServiceImpl" > 
		
		<property name="disbursementVoucherPaymentReasonService">
			<ref bean="disbursementVoucherPaymentReasonService" />	
		</property>
		<property name="disbursementVoucherPayeeService">
			<ref bean="disbursementVoucherPayeeService" />
		</property>
	</bean> 

	<bean id="disbursementVoucherTaxService"  parent="disbursementVoucherTaxService-parentBean" class="edu.cornell.kfs.fp.document.service.impl.CuDisbursementVoucherTaxServiceImpl">
	    <property name="vendorService" ref="vendorService" />
        <property name="parameterEvaluatorService" ref="parameterEvaluatorService" />
	</bean>
	
	<bean id="disbursementVoucherDao" class="edu.cornell.kfs.fp.dataaccess.impl.CuDisbursementVoucherDaoOjb" parent="platformAwareDao" />

    
    <!--  Validations -->
    <bean id="AuxliaryVoucher-accountingDocumentSingleSubFundValidation" class="edu.cornell.kfs.fp.document.validation.impl.CuAuxiliaryVoucherSingleSubFundValidation" abstract="true" />
    
    <bean id="PreEncumbranceAutoDisEncumberValidation" class="edu.cornell.kfs.fp.document.validation.impl.PreEncumbranceAutoDisEncumberValidation" />
	<import resource="document/validation/configuration/FinancialProcessingValidators.xml" />
    <import resource="document/validation/configuration/CU-DisbursementVoucherValidation.xml" />
    <import resource="document/validation/configuration/CuNonCheckDisbursementValidation.xml" />
    <import resource="document/validation/configuration/PreEncumbranceValidation.xml" />
    <import resource="document/validation/configuration/CuYearEndBudgetAdjustmentValidation.xml" />
    <import resource="document/validation/configuration/CuYearEndDistributionOfIncomeAndExpenseValidation.xml" />
    <import resource="document/validation/configuration/CuYearEndGeneralErrorCorrectionValidation.xml" />
    <import resource="document/validation/configuration/CuYearEndTransferOfFundsValidation.xml" />
    <import resource="document/validation/configuration/CuIntraAccountAdjustmentValidation.xml" />
    <import resource="document/validation/configuration/CuAdvanceDepositValidation.xml" />
    <import resource="document/validation/configuration/YearEndJournalVoucherValidation.xml" />
    <import resource="document/validation/configuration/ProcurementCardValidation.xml" />
    
    <bean id="procurementCardDocumentDao" parent="platformAwareDao" class="edu.cornell.kfs.fp.dataaccess.impl.ProcurementCardDocumentDaoOjb" />

    <!-- KFSPTS-1891 not sure why dependency are not injected-->
    <bean id="cUPaymentMethodGeneralLedgerPendingEntryService" class="edu.cornell.kfs.fp.service.impl.CUPaymentMethodGeneralLedgerPendingEntryServiceImpl">
     
    </bean>
    <bean id="recurringDisbursementVoucherDocumentService" parent="recurringDisbursementVoucherDocumentService-parentBean"/>
	<bean id="recurringDisbursementVoucherDocumentService-parentBean" abstract="true" class="edu.cornell.kfs.fp.service.impl.RecurringDisbursementVoucherDocumentServiceImpl">
		<property name="dataDictionaryService" ref="dataDictionaryService"/>
		<property name="documentService" ref="documentService"/>
		<property name="scheduledAccountingLineService" ref="scheduledAccountingLineService"/>
		<property name="businessObjectService" ref="businessObjectService"/>
		<property name="accountingPeriodService" ref="accountingPeriodService"/>
		<property name="recurringDisbursementVoucherSearchDao" ref="recurringDisbursementVoucherSearchDao"/>
		<property name="personService" ref="personService"/>
		<property name="recurringDisbursementVoucherPaymentMaintenanceService" ref="recurringDisbursementVoucherPaymentMaintenanceService"/>
		<property name="routeHeaderService" ref="enDocumentRouteHeaderService"/>
		<property name="cuDisbursementVoucherExtractionHelperService" ref="disbursementVoucherExtractionHelperService"/>
		<property name="noteService" ref="noteService" />
	</bean>
	
	<bean id="recurringDisbursementVoucherPaymentMaintenanceService" parent="recurringDisbursementVoucherPaymentMaintenanceService-parentBean"/>
	<bean id="recurringDisbursementVoucherPaymentMaintenanceService-parentBean" class="edu.cornell.kfs.fp.service.impl.RecurringDisbursementVoucherPaymentMaintenanceServiceImpl" abstract="true">
		<property name="permissionService" ref="permissionService"/>
		<property name="businessObjectService" ref="businessObjectService"/>
		<property name="paymentGroupService" ref="pdpPaymentGroupService"/>
	</bean>
	
    <bean id="recurringDisbursementVoucherSearchDao" class="edu.cornell.kfs.fp.dataaccess.impl.RecurringDisbursementVoucherSearchDaoJdbc" parent="platformAwareDaoJdbc">
        <property name="dateTimeService" ref="dateTimeService"/>
    </bean>

    <!-- KFSUPGRADE-973 -->
	<bean id="disbursementVoucherExtractionHelperService" parent="disbursementVoucherExtractionHelperService-parentBean" class="edu.cornell.kfs.fp.document.service.impl.CuDisbursementVoucherExtractionHelperServiceImpl">
        <property name="paymentMethodGeneralLedgerPendingEntryService" ref="cUPaymentMethodGeneralLedgerPendingEntryService" />
    </bean>
    
    <bean id="yearEndGeneralLedgerPendingEntriesService" parent="yearEndGeneralLedgerPendingEntriesService-parentBean"/>

    <bean id="yearEndGeneralLedgerPendingEntriesService-parentBean" class="edu.cornell.kfs.fp.document.service.impl.YearEndGeneralLedgerPendingEntriesServiceImpl" abstract="true">      
    	<property name="configurationService" ref="kualiConfigurationService" />
    	<property name="dateTimeService" ref="dateTimeService" />  	
    	<property name="homeOriginationService" ref="homeOriginationService" />
        <property name="objectTypeService" ref="objectTypeService" />
        <property name="optionsService" ref="optionsService" />   
        <property name="offsetDefinitionService" ref="offsetDefinitionService" />  
        <property name="parameterService" ref="parameterService" />  
        <property name="flexibleOffsetAccountService" ref="flexibleOffsetAccountService" />
        <property name="subFundGroupService" ref="subFundGroupService" />                 
    </bean>
    
    <bean id="loadAWSBillsBatchJob" parent="scheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="loadAWSBillsStep"/>
            </list>
        </property>
    </bean>
    
    <bean id="loadAWSBillsStep" class="edu.cornell.kfs.fp.batch.LoadAWSBillsStep" parent="step">
       <property name="amazonWebServicesBillingService" ref="amazonWebServicesBillingService"/>
    </bean>
    
    <bean id="amazonWebServicesBillingService" parent="amazonWebServicesBillingService-parent"/>
    <bean id="amazonWebServicesBillingService-parent" class="edu.cornell.kfs.fp.service.impl.AmazonWebServicesBillingServiceImpl" abstract="true">
    	<property name="awsURL">
            <value>${aws.service.url}</value>
        </property>
        <property name="awsToken">
            <value>${aws.service.token}</value>
        </property>
        <property name="parameterService" ref="parameterService"/>
        <property name="documentService" ref="documentService"/>
        <property name="chartService" ref="chartService"/>
        <property name="accountService" ref="accountService"/>
        <property name="subAccountService" ref="subAccountService"/>
        <property name="businessObjectService" ref="businessObjectService"/>
        <property name="objectCodeService" ref="objectCodeService"/>
        <property name="subObjectCodeService" ref="subObjectCodeService"/>
        <property name="projectCodeService" ref="projectCodeService"/>
    </bean>

    <bean id="incomingACHandWiresBatchJob" parent="scheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="loadAchIncomeFileStep"/>
                <ref bean="generateAdvanceDepositDocumentsStep"/>
                <ref bean="routeAdvanceDepositDocumentsStep"/>
            </list>
        </property>
    </bean>

    <bean id="loadAchIncomeFileStep" class="edu.cornell.kfs.fp.batch.LoadAchIncomeFileStep" parent="step">
        <property name="advanceDepositService" ref="advanceDepositService"/>
    </bean>

    <bean id="generateAdvanceDepositDocumentsStep" class="edu.cornell.kfs.fp.batch.GenerateAdvanceDepositDocumentsStep" parent="step">
        <property name="advanceDepositService" ref="advanceDepositService"/>
    </bean>

    <bean id="routeAdvanceDepositDocumentsStep" class="edu.cornell.kfs.fp.batch.RouteAdvanceDepositDocumentsStep" parent="step">
        <property name="advanceDepositService" ref="advanceDepositService"/>
    </bean>

    <bean id="advanceDepositService" parent="advanceDepositService-parent"/>

    <bean id="advanceDepositService-parent" class="edu.cornell.kfs.fp.batch.service.impl.AdvanceDepositServiceImpl" abstract="true">
        <property name="attachmentService" ref="attachmentService"/>
        <property name="bankService" ref="bankService"/>
        <property name="batchInputFileService" ref="batchInputFileService"/>
        <property name="batchInputFileType" ref="achIncomeInputFileType"/>
        <property name="businessObjectService" ref="businessObjectService"/>
        <property name="dateTimeService" ref="dateTimeService"/>
        <property name="documentService" ref="documentService"/>
        <property name="emailService" ref="emailService"/>
        <property name="noteService" ref="noteService"/>
        <property name="parameterService" ref="parameterService"/>
        <property name="personService" ref="personService"/>
        <property name="attachmentsDirectory">
            <value>${attachment.dir.location}</value>
        </property>
    </bean>

    <bean id="achIncomeInputFileType" parent="FlatFileParser">
        <property name="flatFileSpecification">
            <bean class="edu.cornell.kfs.fp.batch.AchIncomeDelimitedFlatFileSpecification">
                <property name="delimiter" value="*"/>
                <property name="objectSpecifications">
                    <list>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="ISA" p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFile">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="9" p:propertyName="fileDate"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="10" p:propertyName="fileTime"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="13" p:propertyName="interchangeControlNumber"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="15" p:propertyName="productionOrTestIndicator"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="GS"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileGroup"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFile"
                              p:parentTargetProperty="groups">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="6" p:propertyName="groupControlNumber"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="groupFunctionIdentifierCode"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="ST"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionSet"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileGroup"
                              p:parentTargetProperty="transactionSets">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="transactionSetControlNumber"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="BPR"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionSet"
                              p:parentTargetProperty="transactionGuts">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="transactionAmount"
                                          p:formatterClass="org.kuali.kfs.sys.businessobject.format.KualiDecimalFormatter"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="3" p:propertyName="creditDebitIndicator"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="4" p:propertyName="paymentMethodCode"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="16" p:propertyName="effectiveDate"
                                          p:formatterClass="org.kuali.kfs.sys.businessobject.format.BatchDateFormatter"
                                          p:dateFormat="yyyyMMdd"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="10" p:propertyName="companyId"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="TRN"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionTrace"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="trace">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="traceNumber"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="REF"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionReference"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="references">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="type"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="value"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="DTM"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionDateTime"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="dateTimes">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="type"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="dateTime"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="N1"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionPayerOrPayeeName"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="payerOrPayees">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="type"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="name"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="3" p:propertyName="idQualifier"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="4" p:propertyName="idCode"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="NM1"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionPremiumReceiverName"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="premiumReceiverName">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="3" p:propertyName="name"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="PER"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionPremiumPayersAdminsContact"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="premiumAdminsContact">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="name"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="NTE"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionNote"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="notes">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="type"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="value"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="RMR"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionOpenItemReference"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransaction"
                              p:parentTargetProperty="openItemReferences">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="type"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="invoiceNumber"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="4" p:propertyName="netAmount"
                                          p:formatterClass="org.kuali.kfs.sys.businessobject.format.KualiDecimalFormatter"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="5" p:propertyName="invoiceAmount"
                                          p:formatterClass="org.kuali.kfs.sys.businessobject.format.KualiDecimalFormatter"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="SE"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionSetTrailer"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTransactionSet"
                              p:parentTargetProperty="transactionSetTrailer">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="transactionSetControlNumber"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="GE"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileGroupTrailer"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileGroup"
                              p:parentTargetProperty="groupTrailer">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="totalTransactionSets"
                                          p:formatterClass="org.kuali.rice.core.web.format.IntegerFormatter"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="groupControlNumber"/>
                                </list>
                            </property>
                        </bean>
                        <bean parent="FlatFilePrefixObjectSpecification"
                              p:linePrefix="IEA"
                              p:businessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFileTrailer"
                              p:parentBusinessObjectClass="edu.cornell.kfs.fp.businessobject.AchIncomeFile"
                              p:parentTargetProperty="trailer">
                            <property name="parseProperties">
                                <list>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="1" p:propertyName="totalGroups"
                                          p:formatterClass="org.kuali.rice.core.web.format.IntegerFormatter"/>
                                    <bean parent="DelimitedFlatFilePropertySpecification"
                                          p:lineSegmentIndex="2" p:propertyName="interchangeControlNumber"/>
                                </list>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
        <property name="directoryPath">
            <value>${staging.directory}/fp/achIncome</value>
        </property>
        <property name="fileExtension">
            <value>txt</value>
        </property>
        <property name="fileNamePrefix" value="achIncome_"/>
        <property name="fileTypeIdentifier" value="achIncomeInputFileType"/>
        <property name="titleKey" value="message.batchUpload.title.achIncome"/>
        <property name="processor" ref="advanceDepositService"/>
    </bean>
    
    <bean id="scheduledAccountingLineService" class="edu.cornell.kfs.fp.service.impl.ScheduledAccountingLineServiceImpl"/>
</beans>
