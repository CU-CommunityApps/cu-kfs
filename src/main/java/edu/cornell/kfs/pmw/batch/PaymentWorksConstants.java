package edu.cornell.kfs.pmw.batch;

import java.util.Arrays;
import java.util.regex.Pattern;

import org.kuali.kfs.sys.KFSConstants;

import edu.cornell.kfs.module.purap.CUPurapConstants;

public class PaymentWorksConstants {
    
    public static final String OUTPUT_ATTRIBUTE_BEGIN_DELIMITER = ":<";
    public static final String OUTPUT_ATTRIBUTE_END_DELIMITER = "> ";
    public static final String OUTPUT_RESTRICTED_DATA_PRESENT = "RestrictedDataPresent";

    public final static String SIMPLE_DATE_FORMAT_REPRESENTATION_FOR_DATE = "MM/dd/yyyy";
    public final static String DIVERSITY_EXPIRATION_DATE_CERTIFIED = "Certified";
    public final static String REGEX_FOR_MM_SLASH_DD_SLASH_YYYY = "^(1[0-2]|0[1-9])/(3[01]|[12][0-9]|0[1-9])/[0-9]{4}$";
    public final static Pattern PATTERN_COMPILED_REGEX_FOR_MM_SLASH_DD_SLASH_YYYY = Pattern.compile(REGEX_FOR_MM_SLASH_DD_SLASH_YYYY);
    
    public static final class PaymentWorksCustomFieldBooleanPrimitive {
        public static final String YES = "YES";
        public static final String NO = "NO";
    }
    
    public static final class PaymentWorksStagingTableColumnConstants {
        public static final String PMW_VENDOR_REQUEST_ID = "pmwVendorRequestId";
    }
    
    public static final class PaymentWorksFieldMappingDatabaseFieldNames {
        public static final String PAYMENT_WORKS_FIELD_ID = "PMW_FIELD_ID";
        public static final String PAYMENT_WORKS_FIELD_LABEL = "PMW_FIELD_LABEL";
        public static final String KFS_PMW_STG_TBL_COL = "KFS_PMW_STG_TBL_COL";
    }
    
    public static final class KFSVendorProcessingStatus {
        public static final String VENDOR_REQUESTED = "Vendor Requested";
        public static final String VENDOR_CREATED = "Vendor Created";
        public static final String VENDOR_REJECTED = "Vendor Rejected";
    }
    
    public static final class KFSAchProcessingStatus {
        public static final String PENDING_PVEN = "Pending PVEN";
    }
    
    public static final class PaymentWorksTransactionType {
        public static final String NEW_VENDOR = "NV";
    }
    
    public static final class PaymentWorksVendorType {
        public static final String PURCHASE_ORDER = "Purchase Order";
    }
    
    public static final class PaymentWorksNewVendorTaxBusinessRule {
        //INDIVIDUAL means "Individual, sole proprietor or single-member LLC" = Yes
        //NOT_INDIVIDUAL means "Individual, sole proprietor or single-member LLC" = No
        public static final int INDIVIDUAL_US_SSN = 1;
        public static final int INDIVIDUAL_US_EIN = 2;
        public static final int NOT_INDIVIDUAL_US = 3;
        public static final int INDIVIDUAL_NOT_US_SSN_OR_ITIN_TAX_CLASS_INDIVIDUAL = 41;
        public static final int INDIVIDUAL_NOT_US_SSN_OR_ITIN_TAX_CLASS_OTHER = 42;  //Generate error when encountered
        public static final int INDIVIDUAL_NOT_US_FOREIGN_TAX_CLASS_INDIVIDUAL = 51;
        public static final int INDIVIDUAL_NOT_US_FOREIGN_TAX_CLASS_OTHER = 52;  //Generate error when encountered
        public static final int NOT_INDIVIDUAL_NOT_US_EIN = 6;
        public static final int NOT_INDIVIDUAL_NOT_US_FOREIGN = 7;
        public static final int COULD_NOT_DETERMINE_TAX_RULE_TO_USE = -1;
    }
    
    public static final class KFSVendorMaintenaceDocumentConstants {
        public static final String DESCRIPTION_SUFFIX = "--new vendor";
        public static final Integer DESCRIPTION_MAX_LENGTH = 40;
        public static final String PAYMENTWORKS_NEW_VENDOR_CREATE_ROUTE_ANNOTATION = "Generated by PaymentWorks New Vendor Create Batch Process";
    }
    
    public static final class KFSVendorContactTypes {
        public static final String ACCOUNTS_RECEIVABLE = "AR";
        public static final String E_INVOICING = "EI";
        public static final String INSURANCE = "IN";
        public static final String SALES = "SR";
        public static final String VENDOR_INFORMATION_FORM = "VI";
    }
    
    public static final class KFSVendorContactPhoneTypes {
        public static final String ACCOUNTS_RECEIVABLE_PHONE = "AR";
        public static final String E_INVOICING = "EI";
        public static final String INSURANCE = "IN";
        public static final String SALES = "SA";
        public static final String VENDOR_INFORMATION = "VI";
    }
    
    public static final class KFSNotesStrings {
        public static final class TEXT_FOR_PVEN_NOTES {
            public static final String W9_URL_EXISTS_IN_PAYMENT_WORKS_MESSAGE = "W9 for this Vendor can be viewed in PaymentWorks.";
            public static final String GOODS_AND_SERVICES_PROVIDED_LABEL = "Goods and Services Provided: ";
            public static final String INITIATOR_LABEL = "Initiator: ";
            public static final String BUSINESS_PURPOSE_LABEL = "Business Purpose: ";
            public static final String CONFLICT_OF_INTEREST_MESSAGE = "Conflict of Interest";
            public static final String CONFLICT_OF_INTEREST_EMPLOYEE_NAME_LABEL = "Employee Name: ";
            public static final String CONFLICT_OF_INTEREST_PHONE_NUMBER_LABEL = "Phone Number: ";
            public static final String CONFLICT_OF_INTEREST_RELATIONSHIP_LABEL = "Relationship: ";
        }
    }
    
    public static final class PaymentWorksBatchReportMessages {
        public static final String NEW_VENDOR_REQUEST_CUSTOM_FIELD_MISSING_ERROR_MESSAGE = " is PaymentWorks New Vendor Request custom field not found in KFS Staging table data elements.";
        public static final String NEW_VENDOR_REQUEST_CUSTOM_FIELD_CONVERSION_EXCEPTION_ERROR_MESSAGE = " generated the following exception attempting custom field mapping to staging table : "; 
        public static final String NEW_VENDOR_DETAIL_DOES_NOT_EXIST_MESSAGE = "No detail data was obtained from PaymentWorks web service call for the vendor ID.";
        public static final String DUPLICATE_NEW_VENDOR_REQUEST_MESSAGE = "Duplicate PaymentWorks Vendor ID detected for New Vendor Request."; 
        public static final String INITIAL_SAVE_TO_PMW_STAGING_TABLE_FAILED = "Initial attempt to save PaymentWorks New Vendor Request to staging table failed.";
        public static final String END_OF_REPORT_MESSAGE = "End of report.";
        public static final String NO_RECORDS_WITH_VALIDATION_ERRORS_MESSAGE = "No records with validation errors.";
        public static final String NO_VALIDATION_ERROR_MESSAGES_TO_OUTPUT = "No validation errors to output.";
        public static final String NO_RECORDS_PROCESSED_MESSAGE = "No records were processed.";
        public static final String MANUAL_DATA_ENTRY_NOT_REQUIRED = "No records requiring manual data entry / manual review.";
    }
    
    public static final class PaymentWorksBatchReportNames {
        public static final String NEW_VENDOR_REQUESTS_REPORT_NAME = "New Vendor Requests Create KFS Vendor";
    }
    
    public static final class PaymentWorksBusinessRuleFailureMessages {
        public static final String COUNTRY_OF_INCORPORATION_BLANK = "PaymentWorks Country of Incorporation/Citizenship is blank.";
        public static final String PRIMARY_ADDRESS_COUNTRY_BLANK = "PaymentWorks Primary Address Country is blank.";
        public static final String REMITTANCE_ADDRESS_COUNTRY_BLANK = "PaymentWorks Remittance Address Country is blank.";
        public static final String BANK_ADDRESS_COUNTRY_BLANK = "PaymentWorks Bank Address Country is blank.";
        public static final String FIPS_TAX_COUNTRY_BLANK = "PaymentWorks Current Country of Tax Residence is blank.";
        public static final String PURCHASE_ORDER_ADDRESS_COUNTRY_BLANK = "PaymentWorks Purchase Order Address Country is blank.";
        public static final String FOREIGN_VENDOR_PROCESSING_NOT_AUTOMATIC_YET = "Currently, only Domestic Vendors can be automatically processed into KFS from PaymentWorks. This Foreign vendor will have to be hand entered."; //REMOVE THIS MESSAGE AFTER FOREIGN VENDORS HAVE BEEN IMPLEMENTED
        public static final String PO_VENDOR_PROCESSING_NOT_AUTOMATIC_YET = "Currently, only DV Vendors can be automatically processed into KFS from PaymentWorks. This PO vendor will have to be hand entered."; //REMOVE THIS MESSAGE AFTER PO VENDORS HAVE BEEN IMPLEMENTED
        public static final String COULD_NOT_DETERMINE_TAX_BUSINESS_RULE_TO_USE = "Data for this vendor does not conform to any of the known Tax Busines Rules. Manual intervention is needed.";
        public static final String NEW_VENDOR_REQUEST_COMBINED_LEGAL_FIRST_LAST_NAME_TOO_LONG_FOR_KFS = "Combining PaymentWorks Legal First Name and Legal Last Name results in too many characters for KFS.";
        public static final String NEW_VENDOR_REQUEST_LEGAL_NAME_TOO_LONG_FOR_KFS = "Legal Name received from PaymentWorks contains too many characters for KFS.";
        public static final String NEW_VENDOR_REQUEST_LEGAL_NAME_NULL_OR_BLANK = "Legal Name was not provided by PaymentWorks.";
        public static final String W8_W9_URL_IS_NULL_OR_BLANK = "W8-W9 URL was not provided by PaymentWorks.";
        public static final String TAX_NUMBER_IS_NULL_OR_BLANK = "Tax Number was not provided by PaymentWorks.";
        public static final String TAX_NUMBER_TYPE_IS_NULL_OR_BLANK = "Tax Number Type was not provided by PaymentWorks.";
        public static final String ISO_COUNTRY_NOT_FOUND = "ISO-to-FIPS mapping table does not contain ISO country : ";
        public static final String SINGLE_ISO_MAPS_TO_MULTIPLE_FIPS = "More than one FIPS Country detected for ISO country : ";
        public static final String DATE_IS_NOT_FORMATTED_CORRECTLY = " date is not formatted correctly. The date received from PaymentWorks was : ";
        public static final String NYS_CERTIFIED_MINORTY_BUSINESS_DESCRIPTION = "NYS Certified MBE Expiration Date";
        public static final String NYS_CERTIFIED_WOMAN_OWNED_BUSINESS_DESCRIPTION = "NYS Certified WBE Expiration Date";
        public static final String NYS_CERTIFIED_DISABLED_VETERAN_BUSINESS_DESCRIPTION = "NYS Certified Disabled Veteran Owned Expiration Date";
    }
    
    public enum PaymentWorksNewVendorRequestStatusType {
        PENDING(0, "0", "Pending"),
        APPROVED(1, "1", "Approved"),
        PROCESSED(2, "2", "Processed"),
        REJECTED(4, "4", "Rejected");
        
        public final int code;
        public final String codeAsString;
        public final String text;
        
        private PaymentWorksNewVendorRequestStatusType(int code, String codeAsString, String text) {
            this.code = code;
            this.codeAsString = codeAsString;
            this.text = text;
        }
        
        public int getCode() {
            return code;
        }
        
        public String getCodeAsString() {
            return codeAsString;
        }
        
        public String getText() {
            return text;
        }
    }
    
    public enum PaymentWorksTinType {
        SSN(0, "0", "SSN", "SSN"),
        FEIN(1, "1", "FEIN", "FEIN"),
        ITIN(2, "2", "ITIN", "NONE"),
        FOREIGN_TIN(3, "3", "Foreign TIN", "NONE");
        
        public final int pmwCode;
        public final String pmwCodeAsString;
        public final String pmwText;
        public final String kfsTaxTypeCodeAsString;
        
        private PaymentWorksTinType(int pmwCode, String pmwCodeAsString, String pmwText, String kfsTaxTypeCodeAsString) {
            this.pmwCode = pmwCode;
            this.pmwCodeAsString = pmwCodeAsString;
            this.pmwText = pmwText;
            this.kfsTaxTypeCodeAsString = kfsTaxTypeCodeAsString;
        }
        
        public int getPmwCode() {
            return pmwCode;
        }
        
        public String getPmwCodeAsString() {
            return pmwCodeAsString;
        }
        
        public String getPmwText() {
            return pmwText;
        }
        
        public String getKfsTaxTypeCodeAsString() {
            return kfsTaxTypeCodeAsString;
        }
    }
    //Constants were declared instead of using the values directly in the 
    //enumeration to allow the use of switch statements in the code.
    public static final int INDIVIDUAL_SOLE_PROPRIETOR_TAX_CLASSIFICATION_INDICATOR  = 0;
    public static final int C_CORPORATION_TAX_CLASSIFICATION_INDICATOR  = 1;
    public static final int S_CORPORATION_TAX_CLASSIFICATION_INDICATOR  = 2;
    public static final int PARTNERSHIP_TAX_CLASSIFICATION_INDICATOR  = 3;
    public static final int TRUST_ESTATE_TAX_CLASSIFICATION_INDICATOR  = 4;
    public static final int LLC_TAXED_AS_C_CORPORATION_TAX_CLASSIFICATION_INDICATOR  = 5;
    public static final int LLC_TAXED_AS_S_CORPORATION_TAX_CLASSIFICATION_INDICATOR  = 6;
    public static final int LLC_TAXED_AS_PARTNERSHIP_TAX_CLASSIFICATION_INDICATOR  = 7;
    public static final int OTHER_TAX_CLASSIFICATION_INDICATOR  = 8;
    public enum PaymentWorksTaxClassification {
        INDIVIDUAL_SOLE_PROPRIETOR(INDIVIDUAL_SOLE_PROPRIETOR_TAX_CLASSIFICATION_INDICATOR, "Individual/sole proprietor or single-member LLC", "ID"),
        C_CORPORATION(C_CORPORATION_TAX_CLASSIFICATION_INDICATOR, "C Corporation", "CP"),
        S_CORPORATION(S_CORPORATION_TAX_CLASSIFICATION_INDICATOR, "S Corporation", "SC"),
        PARTNERSHIP(PARTNERSHIP_TAX_CLASSIFICATION_INDICATOR, "Partnership", "PT"),
        TRUST_ESTATE(TRUST_ESTATE_TAX_CLASSIFICATION_INDICATOR, "Trust/estate", "ET"), 
        LLC_TAXED_AS_C_CORPORATION(LLC_TAXED_AS_C_CORPORATION_TAX_CLASSIFICATION_INDICATOR, "LLC taxed as C Corporation", "CP"),
        LLC_TAXED_AS_S_CORPORATION(LLC_TAXED_AS_S_CORPORATION_TAX_CLASSIFICATION_INDICATOR, "LLC taxed as S Corporation", "SC"),
        LLC_TAXED_AS_PARTNERSHIP(LLC_TAXED_AS_PARTNERSHIP_TAX_CLASSIFICATION_INDICATOR, "LLC taxed as Partnership", "PT"),
        OTHER(OTHER_TAX_CLASSIFICATION_INDICATOR, "Other", "OT");
        
        public final int pmwCode;
        public final String pmwDescription;
        public final String translationToKfsOwnershipTypeCode;
        
        private PaymentWorksTaxClassification(int pmwCode, String pmwDescription, String translationToKfsOwnershipTypeCode) {
            this.pmwCode = pmwCode;
            this.pmwDescription = pmwDescription;
            this.translationToKfsOwnershipTypeCode = translationToKfsOwnershipTypeCode;
        }
        
        public String getTranslationToKfsOwnershipTypeCode() {
            return translationToKfsOwnershipTypeCode;
        }
    }

}
